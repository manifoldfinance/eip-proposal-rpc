---
title: Custom Payload Signature Scheme for Authenticated JSON RPC Service Access
---

> [!NOTE]  
> This is written as an IETF RFC format with adherence to BCP 14

> [!IMPORTANT]  
>  This specification provides a structured approach to implementing a secure and authenticated method for interacting with JSON RPC service endpoints. It ensures that the requests are authenticated and traceable, enhancing the security and usability of the service.

# Custom Payload Signature Scheme for Authenticated JSON RPC Service Access

## Abstract

This document specifies a method for authenticating requests to a JSON RPC service endpoint using a custom payload signature scheme. The scheme involves signing the request payload with an Ethereum key and including this signature in the request headers.

### Introduction

 This specification defines a method for authenticating requests made to a JSON RPC service endpoint. The authentication is achieved by signing the request payload using an Ethereum key and including this signature in the request's HTTP headers. This method ensures that the requests are authenticated and can be tracked over time for user statistics.

### Terminology:

-   JSON RPC: A remote procedure call protocol encoded in JSON.
-   Ethereum Key: A cryptographic key used for signing transactions in the Ethereum blockchain.
-   Payload Signature: A digital signature generated by signing the request payload.
-   X-Flashbots-Signature: HTTP header used to include the payload signature for Flashbots requests.
-   X-Auction-Signature: HTTP header used to include the payload signature for auction requests.

### Specification:

-   Signature Generation:

    -   The client MUST generate a digital signature by signing the hash of the JSON body of the request. The JSON body MUST be encoded as UTF-8 bytes before hashing.
    -   Any valid Ethereum key CAN be used for signing the payload.
    -   The Ethereum address associated with the key used for signing WILL be utilized by the service to track requests and provide user statistics.

-   Request Headers:

    -   The client MUST include the generated signature in the request headers.
    -   For Flashbots requests, the signature MUST be included in the `X-Flashbots-Signature` header.
    -   For auction requests, the signature MUST be included in the `X-Auction-Signature` header.
    -   The headers `X-Flashbots-Signature` and `X-Auction-Signature` are CASE-INSENSITIVE.

-   Example Usage with cURL:
    -   For Flashbots requests:
        ```
        curl -X POST -H "Content-Type: application/json" -H "X-Flashbots-Signature: 0x1234:0xabcd" --data '{"jsonrpc":"2.0","method":"eth_sendBundle","params":[...],"id":1}' <https://api.example.com/v1/auction>
        ```
    -   For auction requests:
        ```
        curl -X POST -H "Content-Type: application/json" -H "X-Auction-Signature: 0x1234:0xabcd" --data '{"jsonrpc":"2.0","method":"eth_sendBundle","params":[...],"id":1}' <https://api.example.com/v1/auction>
        ```

## Security Considerations:

-   The use of Ethereum keys for signing the payload adds a layer of security by ensuring that the sender holds the corresponding private key.
-   Clients MUST protect their Ethereum private keys to prevent unauthorized access and request forgery.

## Backwards Compatibility:

-   This specification does not affect existing JSON RPC implementations that do not use payload signature authentication.
-   Implementations not supporting this scheme WILL treat requests as unauthenticated.

## References:

-   [JSON RPC Specification]
-   [Ethereum Key Management]
-   [Digital Signature Standards]
